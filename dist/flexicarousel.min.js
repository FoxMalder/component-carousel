var Carousel=function(t,i){this.handle=t,this.defaults={activeClass:"active",slideWrap:"ul",slides:"li",infinite:!0,display:1,offscreen:0,disableDragging:!1},this.current=0,this.slides=[],this.sliding=!1,this.cloned=0,this.dragging=!1,this.dragThreshold=50,this.deltaX=0,this.isTouch="ontouchend"in document;var s=document.body.style,e={transform:"transitionend",OTransform:"oTransitionEnd",MozTransform:"transitionend",webkitTransform:"webkitTransitionEnd"};for(var n in e)if(void 0!==s[n]){this.transform=n,this.transitionEnd=e[n];break}this.init(i)};Carousel.prototype={init:function(t){return this.options=this._extend(this.defaults,t),(this.slideWrap=this.handle.querySelector(this.options.slideWrap))&&(this.slides=this.slideWrap.querySelectorAll(this.options.slides))?(this.numSlides=this.slides.length,this.numSlides<this.options.display?void(this.sliding=!0):(this.options.infinite&&this._cloneSlides(this.options.display),this.go(0),this.options.disableDragging||(this.isTouch?(this.handle.addEventListener("touchstart",this._dragStart.bind(this)),this.handle.addEventListener("touchmove",this._drag.bind(this)),this.handle.addEventListener("touchend",this._dragEnd.bind(this)),this.handle.addEventListener("touchcancel",this._dragEnd.bind(this))):(this.handle.addEventListener("mousedown",this._dragStart.bind(this)),this.handle.addEventListener("mousemove",this._drag.bind(this)),this.handle.addEventListener("mouseup",this._dragEnd.bind(this)),this.handle.addEventListener("mouseleave",this._dragEnd.bind(this)))),window.addEventListener("resize",this._updateView.bind(this)),window.addEventListener("orientationchange",this._updateView.bind(this)),this)):void 0},next:function(){this.options.infinite||this.current!==this.numSlides-1?this.go(this.current+1):this.go(this.numSlides-1)},prev:function(){this.options.infinite||0!==this.current?this.go(this.current-1):this.go(0)},go:function(t){if(!this.sliding){if(this.width=this.slides[0].offsetWidth,this.offset=this.cloned*this.width,0>t||t>=this.numSlides){var i=0>t?this.current+this.numSlides:this.current-this.numSlides;this._slide(-(i*this.width-this.deltaX)),this.slideWrap.offsetHeight}t=this._loop(t),this._slide(-(t*this.width),!0),this.options.onSlide&&this.options.onSlide.call(this,t,this.current),this._removeClass(this.slides[this.current],this.options.activeClass),this._addClass(this.slides[t],this.options.activeClass),this.current=t}},_dragStart:function(t){var i;return this.sliding?!1:(t=t.originalEvent||t,i=void 0!==t.touches?t.touches:!1,this.dragThresholdMet=!1,this.dragging=!0,this.cancel=!1,this.startClientX=i?i[0].pageX:t.clientX,this.startClientY=i?i[0].pageY:t.clientY,this.deltaX=0,this.deltaY=0,void(("IMG"===t.target.tagName||"A"===t.target.tagName)&&(t.target.draggable=!1)))},_drag:function(t){var i,s=Math.abs;this.dragging&&!this.cancel&&(t=t.originalEvent||t,i=void 0!==t.touches?t.touches:!1,this.deltaX=(i?i[0].pageX:t.clientX)-this.startClientX,this.deltaY=(i?i[0].pageY:t.clientY)-this.startClientY,this.dragThresholdMet||s(this.deltaX)>s(this.deltaY)&&s(this.deltaX)>10?(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.dragThresholdMet=!0,this._slide(-(this.current*this.width-this.deltaX))):s(this.deltaY)>s(this.deltaX)&&s(this.deltaY)>10&&(this.cancel=!0))},_dragEnd:function(){this.dragging&&!this.cancel&&(this.dragging=!1,0!==this.deltaX&&Math.abs(this.deltaX)<this.dragThreshold?this.go(this.current):this.deltaX>0?this.prev():this.deltaX<0&&this.next(),this.deltaX=0)},_slide:function(t,i){if(t-=this.offset,i){this.sliding=!0,this._addClass(this.slideWrap,"animate");var s=400,e=this;setTimeout(function(){e.sliding=!1,e._removeClass(e.slideWrap,"animate")},s)}this.transform?this.slideWrap.style[this.transform]="translate3d("+t+"px, 0, 0)":this.slideWrap.style.left=t+"px"},_loop:function(t){return(this.numSlides+t%this.numSlides)%this.numSlides},_updateView:function(){var t=this;clearTimeout(this.timer),this.timer=setTimeout(function(){t.go(t.current)},300)},_cloneSlides:function(){var t,i,s,e;for(i=this.options.display+this.options.offscreen-1,i=i>this.numSlides?this.numSlides:i,t=this.numSlides-this.options.offscreen-1,e=this.numSlides;e>t;e--)s=this.slides[e-1].cloneNode(!0),s.removeAttribute("id"),s.setAttribute("aria-hidden","true"),this._addClass(s,"clone"),this.slideWrap.insertBefore(s,this.slideWrap.firstChild),this.cloned++;for(e=0;i>e;e++)s=this.slides[e].cloneNode(!0),s.removeAttribute("id"),s.setAttribute("aria-hidden","true"),this._addClass(s,"clone"),this.slideWrap.appendChild(s)},_addClass:function(t,i){t.classList?t.classList.add(i):t.className+=" "+i},_removeClass:function(t,i){t.classList?t.classList.remove(i):t.className=t.className.replace(new RegExp("(^|\\b)"+i.split(" ").join("|")+"(\\b|$)","gi")," ")},_extend:function(t){for(var i=Array.prototype.slice.call(arguments,1),s=0;s<i.length;s++){var e=i[s];if(e)for(var n in e)t[n]=e[n]}return t}};