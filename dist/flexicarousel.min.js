var Carousel=function(i,t){this.handle=i,this.defaults={activeClass:"active",slideWrap:"ul",slides:"li",infinite:!0,display:1,offscreen:0,disableDragging:!1},this.current=0,this.slides=[],this.sliding=!1,this.cloned=0,this.dragging=!1,this.dragThreshold=50,this.deltaX=0,this.isTouch="ontouchend"in document;var s=document.body.style,e={transform:"transitionend",OTransform:"oTransitionEnd",MozTransform:"transitionend",webkitTransform:"webkitTransitionEnd"};for(var n in e)if(void 0!==s[n]){this.transform=n,this.transitionEnd=e[n];break}this.init(t)};Carousel.prototype={init:function(i){return this.options=this._extend(this.defaults,i),(this.slideWrap=this.handle.querySelector(this.options.slideWrap))&&(this.slides=this.slideWrap.querySelectorAll(this.options.slides))?(this.numSlides=this.slides.length,this.numSlides<this.options.display?void(this.sliding=!0):(this.options.infinite&&this._cloneSlides(this.options.display),this.go(0),this.options.disableDragging||(this.isTouch?(this.slideWrap.addEventListener("touchstart",this._dragStart.bind(this)),this.slideWrap.addEventListener("touchmove",this._drag.bind(this)),this.slideWrap.addEventListener("touchend",this._dragEnd.bind(this)),this.slideWrap.addEventListener("touchcancel",this._dragEnd.bind(this))):(this.slideWrap.addEventListener("mousedown",this._dragStart.bind(this)),this.slideWrap.addEventListener("mousemove",this._drag.bind(this)),this.slideWrap.addEventListener("mouseup",this._dragEnd.bind(this)),this.slideWrap.addEventListener("mouseleave",this._dragEnd.bind(this)))),window.addEventListener("resize",this._updateView.bind(this)),window.addEventListener("orientationchange",this._updateView.bind(this)),this)):void 0},next:function(){this.options.infinite||this.current!==this.numSlides-1?this.go(this.current+1):this.go(this.numSlides-1)},prev:function(){this.options.infinite||0!==this.current?this.go(this.current-1):this.go(0)},go:function(i){if(!this.sliding){if(this.width=this.slides[0].offsetWidth,this.offset=this.cloned*this.width,0>i||i>=this.numSlides){var t=0>i?this.current+this.numSlides:this.current-this.numSlides;this._slide(-(t*this.width-this.deltaX)),this.slideWrap.offsetHeight}i=this._loop(i),this._slide(-(i*this.width),!0),this.options.onSlide&&this.options.onSlide.call(this,i,this.current),this._removeClass(this.slides[this.current],this.options.activeClass),this._addClass(this.slides[i],this.options.activeClass),this.current=i}},_dragStart:function(i){var t;return this.sliding?!1:(i=i.originalEvent||i,t=void 0!==i.touches?i.touches:!1,this.dragThresholdMet=!1,this.dragging=!0,this.cancel=!1,this.startClientX=t?t[0].pageX:i.clientX,this.startClientY=t?t[0].pageY:i.clientY,this.deltaX=0,this.deltaY=0,void(("IMG"===i.target.tagName||"A"===i.target.tagName)&&(i.target.draggable=!1)))},_drag:function(i){var t,s=Math.abs;this.dragging&&!this.cancel&&(i=i.originalEvent||i,t=void 0!==i.touches?i.touches:!1,this.deltaX=(t?t[0].pageX:i.clientX)-this.startClientX,this.deltaY=(t?t[0].pageY:i.clientY)-this.startClientY,this.dragThresholdMet||s(this.deltaX)>s(this.deltaY)&&s(this.deltaX)>10?(i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation(),this.dragThresholdMet=!0,this._slide(-(this.current*this.width-this.deltaX))):s(this.deltaY)>s(this.deltaX)&&s(this.deltaY)>10&&(this.cancel=!0))},_dragEnd:function(){this.dragging&&!this.cancel&&(this.dragging=!1,0!==this.deltaX&&Math.abs(this.deltaX)<this.dragThreshold?this.go(this.current):this.deltaX>0?this.prev():this.deltaX<0&&this.next(),this.deltaX=0)},_slide:function(i,t){if(i-=this.offset,t){this.sliding=!0,this._addClass(this.slideWrap,"animate");var s=400,e=this;setTimeout(function(){e.sliding=!1,e._removeClass(e.slideWrap,"animate")},s)}this.transform?this.slideWrap.style[this.transform]="translate3d("+i+"px, 0, 0)":this.slideWrap.style.left=i+"px"},_loop:function(i){return(this.numSlides+i%this.numSlides)%this.numSlides},_updateView:function(){var i=this;clearTimeout(this.timer),this.timer=setTimeout(function(){i.go(i.current)},300)},_cloneSlides:function(){var i,t,s,e;for(t=this.options.display+this.options.offscreen-1,t=t>this.numSlides?this.numSlides:t,i=this.numSlides-this.options.offscreen-1,e=this.numSlides;e>i;e--)s=this.slides[e-1].cloneNode(!0),s.removeAttribute("id"),s.setAttribute("aria-hidden","true"),this._addClass(s,"clone"),this.slideWrap.insertBefore(s,this.slideWrap.firstChild),this.cloned++;for(e=0;t>e;e++)s=this.slides[e].cloneNode(!0),s.removeAttribute("id"),s.setAttribute("aria-hidden","true"),this._addClass(s,"clone"),this.slideWrap.appendChild(s)},_addClass:function(i,t){i.classList?i.classList.add(t):i.className+=" "+t},_removeClass:function(i,t){i.classList?i.classList.remove(t):i.className=i.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},_extend:function(i){for(var t=Array.prototype.slice.call(arguments,1),s=0;s<t.length;s++){var e=t[s];if(e)for(var n in e)i[n]=e[n]}return i}};